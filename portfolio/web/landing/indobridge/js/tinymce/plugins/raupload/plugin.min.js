tinymce.PluginManager.add('raupload', function(editor, url) {
	// Initiate files and folder
	var site_url = $('meta[name=site_url]').attr('content'),
		base_url = site_url.replace('index.php',''),
		media_form = 'media.form.php',
		media_finder = 'media.finder.php',
		files_form = 'files.form.php',
		files_finder = 'files.finder.php'
		// upload_func = 'dashboard/upload',
		// media_finder_func = 'dashboard/media',
		// files_finder_func = 'dashboard/files',
		// download_path = 'download/files';
	// Add a button that opens a window
	editor.addButton('raupload', {
		id: 'raupload',	icon: 'fa fa-camera', title: 'Insert / Upload Image',
		onclick: function() {
			var upload_media_url = url + '/' + media_form,
				upload_media_return = true;

			$.ajax({
				url: site_url + '/' + media_finder_func, async: false,dataType:'json'
				success: function(data) {
					if ( data.status == false ) upload_media_return = false;
					else upload_media_url = url + '/' + media_finder;
				}
			});
			// Open window
			editor.windowManager.open({
				title: 'Insert Image', url: upload_media_url, width: 800, height:400,
			},{
				base_url: base_url, upload_dir: 'uploads/',site_url: site_url, plugin_url: url,
				upload_func: site_url +'/' + upload_func, media_finder_func: site_url + '/' + media_finder_func,
				upload_media_return: upload_media_return, return_data: false
			});
		}
	});
	// test
	editor.addButton('rafiles', {
		id: 'rafiles', icon: 'fa fa-download', title: 'Set Download',
		onclick: function() {
			var upload_files_url = url + '/' + files_form,
				upload_media_return = true;
			$.ajax({
				url: site_url + '/' + files_finder_func, async: false,
				success: function(data) {
					if ( data.status == false ) upload_media_return = false;
					else upload_files_url = url + '/' + files_finder;
				},
				dataType:'json'
			});
			// Open window
			editor.windowManager.open({
				title: 'Insert / Set Download File', url: upload_files_url, width: 800, height:400,
			},{
				base_url: base_url, upload_dir: './uploads/',site_url: site_url, plugin_url: url, download_path: download_path,
				upload_func: site_url +'/' + upload_func, media_finder_func: site_url + '/' + files_finder_func,
				upload_media_return: upload_media_return, return_data: false
			});
		}
	});
});